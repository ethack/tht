<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.82.0"><meta name=description content="Like `cut` but with column names and CSV/TSV/JSON/Zeek support without the boilerplate.
"><meta name=author content="Ethan Robish"><title>Chop :: Threat Hunting Toolkit</title><link href=/tht/css/nucleus.css?1666611205 rel=stylesheet><link href=/tht/css/fontawesome-all.min.css?1666611205 rel=stylesheet><link href=/tht/css/featherlight.min.css?1666611205 rel=stylesheet><link href=/tht/css/perfect-scrollbar.min.css?1666611205 rel=stylesheet><link href=/tht/css/auto-complete.css?1666611205 rel=stylesheet><link href=/tht/css/theme.css?1666611205 rel=stylesheet><link href=/tht/css/theme-blue.css?1666611205 rel=stylesheet><link href=/tht/css/variant.css?1666611205 rel=stylesheet><link href=/tht/css/print.css?1666611205 rel=stylesheet media=print><script src=/tht/js/jquery.min.js?1666611205></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}:not(pre)>code+span.copy-to-clipboard{display:none}</style><link href=/tht/css/custom.css?1666611205 rel=stylesheet><link href=/tht/css/highlightjs/rainbow.css?1666611205 rel=stylesheet></head><body data-url=/tht/filter/chop/><script>var index_url="/tht/index.json",root_url="/",baseUri=root_url.replace(/\/$/,'')</script><nav id=sidebar><div id=header-wrapper><div id=header><h3>Threat Hunting Toolkit</h3></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script src=/tht/js/lunr.min.js?1666611205></script><script src=/tht/js/auto-complete.js?1666611205></script><script src=/tht/js/search.js?1666611205></script></div><div id=homelinks><ul><li><a class=padding href=/tht/><i class="fas fa-home"></i> Home</a></li></ul></div><div class=highlightable><ul class=topics><li data-nav-id=/tht/filter/ title=Filter class="dd-item parent"><a href=/tht/filter/>Filter</a><ul><li data-nav-id=/tht/filter/chop/ title=Chop class="dd-item active"><a href=/tht/filter/chop/>Chop</a></li><li data-nav-id=/tht/filter/filter/ title=Filter class=dd-item><a href=/tht/filter/filter/>Filter</a></li></ul></li><li data-nav-id=/tht/summarize/ title=Summarize class=dd-item><a href=/tht/summarize/>Summarize</a><ul><li data-nav-id=/tht/summarize/conn-summary/ title="Conn Summary" class=dd-item><a href=/tht/summarize/conn-summary/>Conn Summary</a></li></ul></li><li data-nav-id=/tht/correlate/ title=Correlate class=dd-item><a href=/tht/correlate/>Correlate</a><ul></ul></li><li data-nav-id=/tht/visualize/ title=Visualize class=dd-item><a href=/tht/visualize/>Visualize</a><ul></ul></li><li data-nav-id=/tht/multipurpose/ title=Multipurpose class=dd-item><a href=/tht/multipurpose/>Multipurpose</a><ul></ul></li><li data-nav-id=/tht/utils/ title=Utils class=dd-item><a href=/tht/utils/>Utils</a><ul></ul></li><li data-nav-id=/tht/development/ title=Development class=dd-item><a href=/tht/development/>Development</a><ul></ul></li></ul><div id=footer><div id=copyright><p xmlns:cc=http://creativecommons.org/ns#>This work is licensed under <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/?ref=chooser-v1" target=_blank rel="license noopener noreferrer" style=display:inline-block>CC BY-NC-SA 4.0<img style=height:22px!important;margin-left:3px;vertical-align:text-bottom src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img style=height:22px!important;margin-left:3px;vertical-align:text-bottom src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"><img style=height:22px!important;margin-left:3px;vertical-align:text-bottom src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1"><img style=height:22px!important;margin-left:3px;vertical-align:text-bottom src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1"></a></p></div></div></div></nav><div id=body><div id=overlay></div><div class="padding highlightable"><div id=top-bar><div id=breadcrumbs><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3"><a itemprop=item href=/tht/><span itemprop=name>Introduction</span></a> ></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="2"><a itemprop=item href=/tht/filter/><span itemprop=name>Filter</span></a> ></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="1"><a itemprop=item href=/tht/filter/chop/ aria-disabled=true><span itemprop=name>Chop</span></a></li></ol></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#examples>Examples</a></li></ul></nav></div></div></div><div id=head-tags></div><main id=body-inner><h1>Chop</h1><h2 id=overview>Overview</h2><p>One of the most common ways to transform data is to select certain columns to keep, while discarding the rest. This is exactly what <code>chop</code> does. You can accomplish the same thing with <code>awk</code>, <code>cut</code>, <code>zeek-cut</code>, <code>jq</code>, etc. but without changing your tool or syntax when your log format changes.</p><p>Here&rsquo;s a comparison between the different tools and log types they support.</p><table><thead><tr><th>Command</th><th>Zeek TSV</th><th>JSON</th><th>CSV</th><th>TSV</th><th>Whitespace</th><th>Custom</th></tr></thead><tbody><tr><td><code>chop</code></td><td>✔️</td><td>✔️</td><td>✔️</td><td>✔️</td><td>✔️</td><td>✔️</td></tr><tr><td><code>awk</code></td><td>✔️ †</td><td></td><td>✔️ ††</td><td>✔️ ††</td><td>✔️</td><td>✔️</td></tr><tr><td><code>cut</code></td><td>✔️ †</td><td></td><td>✔️ ††</td><td>✔️ ††</td><td>✔️ †††</td><td>✔️</td></tr><tr><td><code>zeek-cut</code></td><td>✔️</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td><code>jq</code></td><td></td><td>✔️</td><td></td><td></td><td></td><td></td></tr><tr><td><code>json-cut</code></td><td></td><td>✔️</td><td></td><td></td><td></td><td></td></tr><tr><td><code>zq 'cut'</code></td><td>✔️</td><td>✔️</td><td></td><td></td><td></td><td></td></tr><tr><td><code>mlr cut</code></td><td></td><td>✔️</td><td>✔️</td><td>✔️</td><td>✔️</td><td></td></tr><tr><td><code>xsv select</code></td><td></td><td></td><td>✔️</td><td>✔️</td><td></td><td>✔️</td></tr><tr><td><code>tsv-select</code></td><td>✔️ †</td><td></td><td>✔️</td><td>✔️</td><td></td><td>✔️</td></tr></tbody></table><ul><li>† returns junk from metadata</li><li>†† will not handle quoted values containing delimeter</li><li>††† can pick space or tab but not both</li></ul><p>Can you pre-process and post-process data and make most of these tools work? Sure. But why not let <code>chop</code> do it for you instead?</p><p>The best way to illustrate this is with examples.</p><h2 id=examples>Examples</h2><p>Let&rsquo;s say you want to pull out the destination IPs and ports from a Zeek TSV file. Here are some traditional ways you might do this.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>zeek-cut id.resp_h id.resp_p
awk <span style=color:#e6db74>&#39;{print $6,$7}&#39;</span>
cut -d<span style=color:#e6db74>$&#39;\t&#39;</span> -f6,7
zq -f text <span style=color:#e6db74>&#39;cut id.resp_h,id.resp_p&#39;</span>
sed -e <span style=color:#e6db74>&#39;0,/^#fields\t/s///&#39;</span> | grep -v <span style=color:#e6db74>&#39;^#&#39;</span> | xsv <span style=color:#66d9ef>select</span> -d <span style=color:#e6db74>&#39;\t&#39;</span> id.resp_h,id.resp_p
mlr --prepipe <span style=color:#e6db74>&#34;sed &#39;0,/^#fields\t/s///&#39;&#34;</span> --tsv --skip-comments cut -f id.resp_h,id.resp_p
</code></pre></div><p><code>chop</code> borrows its simplicity from <code>zeek-cut</code> to accomplish the same task.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>chop id.resp_h id.resp_p
chop id.resp_h,id.resp_p
</code></pre></div><p>If your logs don&rsquo;t have headers (or you just prefer not to use them) you can specify field indexes instead.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>chop 6,7
chop <span style=color:#ae81ff>6</span> <span style=color:#ae81ff>7</span>
<span style=color:#75715e># a range will also work</span>
chop 6-7
</code></pre></div><div class="notices tip"><div class=label>Tip</div><p><code>chop</code> lets you specify fields with spaces, commas, or mix-and-match!</p></div><p>Now let&rsquo;s say you want to do the same thing (pull out the destination IPs and ports) but this time from a Zeek JSON file.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>json-cut id.resp_h id.resp_p
zq -f text <span style=color:#e6db74>&#39;cut id.orig_h,id.resp_h,id.resp_p&#39;</span>
jq -c <span style=color:#e6db74>&#39;{&#34;id.resp_h&#34;, &#34;id.resp_p&#34;}&#39;</span>
mlr --json cut -f id.resp_h,id.resp_p
</code></pre></div><div class="notices note"><div class=label>Note</div><p>Since JSON objects are sparse and un-ordered it doesn&rsquo;t make sense to specify a field by its numerical index.</p></div><p>Unless you were using <code>zq</code> you&rsquo;ve already had to dust off a new tool and learn/remember its syntax. <code>chop</code> lets you use the same simple syntax you&rsquo;ve already learned.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>chop id.resp_h id.resp_p
</code></pre></div><p>Next, let&rsquo;s say you want the <code>src</code> (1st column) and <code>dst</code> (3rd column) fields from a firewall log CSV file. Once again, starting with the traditional methods.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>awk -F, <span style=color:#e6db74>&#39;{print $1,$3}&#39;</span>
cut -d, -f1,3
xsv <span style=color:#66d9ef>select</span> src,dst
xsv <span style=color:#66d9ef>select</span> 1,3
mlr --csv cut -f src,dst
</code></pre></div><p>That&rsquo;s not <em>too</em> bad. But you still have unnecessary command switches and boilerplate compared to <code>chop</code>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>chop src dst
chop 1,3
</code></pre></div><p>And what if those <code>src</code> and <code>dst</code> columns were whitespace separated?</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>awk <span style=color:#e6db74>&#39;{print $1,$3}&#39;</span>
cut -d<span style=color:#e6db74>&#39; &#39;</span> -f1,3    <span style=color:#75715e># only if space separated, not both</span>
cut -d<span style=color:#e6db74>$&#39;\t&#39;</span> -f1,3  <span style=color:#75715e># only if tab separated, not both</span>
mlr --pprint cut -f src,dst
</code></pre></div><p>By now, you&rsquo;ve guessed it. <code>chop</code>&rsquo;s syntax remains the same. Not only can you keep the same syntax between file formats, but you don&rsquo;t have to think about which separators are used.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>chop src dst
chop 1,3
</code></pre></div><p>Before <code>chop</code>, each scenario would require you to reach for a different tool and then figure out the syntax or transformations to get it working with your data. In the end, you&rsquo;d have a command that&rsquo;s cumbersome to type and unlikely to be used as-is for another log format.</p><div class="notices tip"><div class=label>Tip</div><p>Just like with other tools, you can specify a custom single character as a delimeter with <code>chop</code>. E.g. <code>chop -d'|'</code> or <code>chop -d':'</code>.</p></div><footer class=footline></footer></main></div><div id=navigation><a class="nav nav-prev" href=/tht/filter/ title=Filter><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/tht/filter/filter/ title=Filter><i class="fa fa-chevron-right"></i></a></div></div><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/tht/js/clipboard.min.js?1666611205></script><script src=/tht/js/perfect-scrollbar.min.js?1666611205></script><script src=/tht/js/perfect-scrollbar.jquery.min.js?1666611205></script><script src=/tht/js/jquery.svg.pan.zoom.js?1666611205></script><script src=/tht/js/featherlight.min.js?1666611205></script><script src=/tht/js/modernizr.custom-3.6.0.js?1666611205></script><script src=/tht/js/relearn.js?1666611205></script></body></html>